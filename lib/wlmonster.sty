% Monster environment sty file

\RequirePackage{lib/wlutils}

% Monster box made to look like the Monster Manual NPC definitions
\newtcolorbox{monsterboxnobg}[2][]{
	enhanced,
	frame hidden,
	boxrule=0pt,
	breakable,
	boxsep=0pt,
	toptitle=3mm,
	left=0pt,
	right=0pt,
	arc=0mm,
	opacityback=0,
	colframe=titlered,
	fonttitle=\wl@StatBlockTitleFont\Large,
	fontupper=\wl@StatBlockBodyFont,
	title=#2,
	coltitle=titlered,
	#1
}

% new Monsterbox
\iftoggle{bool-bg}{
	\newtcolorbox{monsterbox}[2][]{
		enhanced,
		frame hidden,
		before skip=7pt plus 2pt,
		boxrule=0pt,
		breakable,
		boxsep=0pt,
		toptitle=11pt,
		left=7pt,
		right=7pt,
		bottom=11pt,
		arc=0mm,
		oversize=0pt,
		borderline north={4pt}{0pt}{titlered},
		borderline north={2.5pt}{0.75pt}{statblockribbon},
		borderline south={4pt}{0pt}{titlered},
		borderline south={2.5pt}{0.75pt}{statblockribbon},
		colback=statblockbg,
		colbacktitle=statblockbg,
		colframe=titlered,
		fonttitle=\wl@StatBlockTitleFont\Large,
		coltitle=titlered,
		fontupper=\wl@StatBlockBodyFont,
		title=#2,
		#1
	}
}{
	\let\monsterbox\monsterboxnobg%
	\let\endmonsterbox\endmonsterboxnobg%
}


% Define Monster subsection header style
%\newcommand{\monstersection}[1]{\subsubsection*{#1}}
\newcommand{\monstersection}[1]{
	\begingroup
		\par\medskip\color{titlered}
		\wl@StatBlockSubtitleFont\large #1 \vspace{3pt}
		\titleline{\titlerule[0.6pt]}
		\vspace{3pt}
	\endgroup
}

\newenvironment{monsteraction}[1][\unskip]{
	\smallskip\emph{\textbf{#1.}}}{\\}

%


% Taubular enviornment for stats-block
\newkeycommand\stats[
	STR=2,
	VIT=2,
	AGI=2,
	INT=2,
	CHA=2,
	STY=2,
	WIL=2,
	SEN=2,
	MAG=2,
	LUC=2]{%

	\begin{tabularx}{\linewidth}{XXXX}
\textbf{\strstat} & \stat{\commandkey{STR}} & 
\textbf{\vitstat} & \stat{\commandkey{VIT}} \\
\textbf{\agistat} & \stat{\commandkey{AGI}} & 
\textbf{\intstat} & \stat{\commandkey{INT}} \\
\textbf{\chastat} & \stat{\commandkey{CHA}} & 
\textbf{\stystat} & \stat{\commandkey{STY}} \\
\textbf{\wilstat} & \stat{\commandkey{WIL}} & 
\textbf{\senstat} & \stat{\commandkey{SEN}} \\
\textbf{\magstat} & \stat{\commandkey{MAG}} & 
\textbf{\lucstat} & \stat{\commandkey{LUC}} \\
	\end{tabularx}

}

\newcommand{\attacks}{\monstersection{\attacksname}}
\newcommand{\defense}{\monstersection{\defensename}}

\newcommand{\shortskill}[2]{\textbf{#1}: #2}
